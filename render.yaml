services:
  - type: web
    name: fhir-mcp-server
    runtime: docker
    plan: free
    region: oregon
    branch: main
    dockerfilePath: ./Dockerfile
    dockerContext: .
    
    # Environment variables
    envVars:
      # MCP Server Configuration
      - key: FHIR_MCP_HOST
        value: 0.0.0.0
      
      - key: FHIR_MCP_PORT
        value: 8000
      
      - key: FHIR_MCP_REQUEST_TIMEOUT
        value: 30
      
      # FHIR Server Configuration (Required)
      - key: FHIR_SERVER_BASE_URL
        sync: false
        # Set this in Render Dashboard or use generateValue: true for secrets
        # Example: https://hapi.fhir.org/baseR5
      
      # Optional: Set to True to disable authorization
      - key: FHIR_SERVER_DISABLE_AUTHORIZATION
        value: False
      
      # For Authenticated FHIR servers (Optional)
      - key: FHIR_SERVER_CLIENT_ID
        sync: false
      
      - key: FHIR_SERVER_CLIENT_SECRET
        sync: false
      
      - key: FHIR_SERVER_SCOPES
        value: "user/DocumentReference.read patient/DiagnosticReport.read user/DiagnosticReport.read user/Media.read patient/AllergyIntolerance.read patient/Patient.read patient/Immunization.read user/MedicationDispense.read patient/CareTeam.read user/Patient.read user/Procedure.read user/Organization.read user/Device.read user/Binary.read patient/Device.read user/QuestionnaireResponse.read patient/MedicationAdministration.read patient/Medication.read user/Coverage.read patient/MedicationDispense.read patient/Encounter.read user/Location.read user/Practitioner.read patient/Binary.read user/Medication.read patient/Condition.read patient/MedicationRequest.read patient/Media.read patient/ServiceRequest.read user/PractitionerRole.read patient/Location.read user/CareTeam.read patient/DocumentReference.read patient/QuestionnaireResponse.read patient/Coverage.read user/AllergyIntolerance.read patient/Organization.read user/RelatedPerson.read user/Immunization.read patient/Goal.read patient/Practitioner.read user/Condition.read user/Encounter.read patient/Provenance.read patient/Specimen.read user/MedicationRequest.read patient/PractitionerRole.read patient/Procedure.read user/Provenance.read user/Observation.read user/Specimen.read user/MedicationAdministration.read user/CarePlan.read patient/CarePlan.read user/ServiceRequest.read patient/Observation.read patient/RelatedPerson.read user/Goal.read"
      
      # Optional: Direct access token (skips authorization flow)
      # - key: FHIR_SERVER_ACCESS_TOKEN
      #   sync: false
      
      # Optional: Include 'aud' parameter in authorization request
      - key: FHIR_SERVER_INCLUDE_AUD
        value: True
      
      # Optional: Use Basic auth for token exchange
      - key: FHIR_SERVER_ENABLE_BASIC_AUTH
        value: True
      
      # Optional: Custom server URL (overrides host:port)
      # - key: FHIR_MCP_SERVER_URL
      #   sync: false

    # Auto-deploy on push to main branch
    autoDeploy: true

